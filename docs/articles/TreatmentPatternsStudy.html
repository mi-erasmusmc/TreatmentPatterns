<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Perform a study using the TreatmentPatterns package • TreatmentPatterns</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Perform a study using the TreatmentPatterns package">
<meta property="og:description" content="TreatmentPatterns">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreatmentPatterns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DarwinTreatmentPatternsStudy.html">Perform a Darwin study using the TreatmentPatterns package</a>
    </li>
    <li>
      <a href="../articles/TreatmentPatternsStudy.html">Perform a study using the TreatmentPatterns package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Perform a study using the TreatmentPatterns
package</h1>
                        <h4 data-toc-skip class="author">Aniek F
Markus</h4>
            
            <h4 data-toc-skip class="date">2023-03-03</h4>
      
      
      <div class="hidden name"><code>TreatmentPatternsStudy.Rmd</code></div>

    </div>

    
    
<p>This vignette describes how to perform a treatment patterns study in
five steps:</p>
<ul>
<li>Step 0: installation</li>
<li>Step 1: define target/event cohorts (cohortSettings)</li>
<li>Step 2: (optional, only for OMOP-CDM data) specify baseline
characteristics of interest (characterizationSettings)</li>
<li>Step 3: specify settings to construct treatment pathways
(pathwaySettings)</li>
<li>Step 4: execute study</li>
<li>Step 5: check out results</li>
</ul>
<p>In this vignette we will use an example describing the treatment
patterns of hypertension patients. The included drugs of interests are
hydrochlorothiazide, metorolol, amlodipine, lisinopril, and losartan
(note: this example is purely for illustrative purposes - for simplicity
we limit it to 5 events of interest).</p>
<div class="section level2">
<h2 id="step-0-installation">Step 0: installation<a class="anchor" aria-label="anchor" href="#step-0-installation"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>See the instructions <a href="https://ohdsi.github.io/Hades/rSetup.html" class="external-link">here</a> for
configuring your R environment, including RTools and Java.</p></li>
<li><p>In R, use the following commands to download and install
TreatmentPatterns:</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mi-erasmusmc/TreatmentPatterns"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-1-define-targetevent-cohorts-cohortsettings">Step 1: define target/event cohorts (cohortSettings)<a class="anchor" aria-label="anchor" href="#step-1-define-targetevent-cohorts-cohortsettings"></a>
</h2>
<p>The package works with cohorts, you need to define (at least one)
target and (multiple) event cohorts. For each individual in a target
cohort, the package extracts the event cohorts from the medical file
after the index date.</p>
<ul>
<li><p>Target cohort (= study population) is a set of patients who
satisfy one or more inclusion criteria for a duration of time. When
defining the target cohort it might be desirable to request a minimum
follow up time after the index date to have sufficient information on
treatment history. The index date of the target cohort is the point in
time from which treatments of interest will be included in treatment
pathways.</p></li>
<li><p>Event cohort(s) (= treatment(s) of interest). You need to define
a cohort for each treatment of interest (e.g. prescriptions of drugs,
therapies, other treatments) that should be included in the treatment
pathway.</p></li>
</ul>
<p>Cohorts can be generated based on a definition in ATLAS (<a href="https://ohdsi.github.io/TheBookOfOhdsi/Cohorts.html" class="external-link uri">https://ohdsi.github.io/TheBookOfOhdsi/Cohorts.html</a>) or
imported directly in the package from a csv file. Cohorts have the
following columns:</p>
<table class="table">
<colgroup>
<col width="22%">
<col width="31%">
<col width="23%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="left">cohortId</th>
<th align="left">personId</th>
<th align="left">startDate</th>
<th align="left">endDate</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Unique ID number</td>
<td align="left">Unique person ID number</td>
<td align="left">Entry date cohort</td>
<td align="left">Exit date cohort</td>
</tr></tbody>
</table>
<p>Date format: yyyy-mm-dd.</p>
<p>Note that there are multiple ways of defining target/event cohorts.
For the example in this vignette, we defined the following target and
event cohorts:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Example: target cohort - Hypertension</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Cohort Entry Events<span class="sc">:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  People with continuous observation of <span class="dv">365</span> days before and <span class="dv">1</span>,<span class="dv">095</span> days after event</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>may enter the cohort when observing any of the following<span class="sc">:</span> drug eras of</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">'Hypertension drugs'</span>.</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>Limit cohort entry events to the earliest event per person.</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Inclusion Criteria<span class="sc">:</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.</span> Hypertension diagnosis<span class="sc">:</span> Entry events having at least <span class="dv">1</span> condition occurrence of</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="st">'Hypertension diagnosis'</span>, starting anytime up to <span class="dv">30</span> days after cohort entry start date;</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>allow events outside observation period.</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> Index year<span class="sc">:</span> Entry events with the following event criteria<span class="sc">:</span> starting after</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>December <span class="dv">31</span>, <span class="fl">2009.</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we use the moment of drug exposure as index date,</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively the moment of diagnosis could be used.</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a study design choice.</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Example: event cohort - Hydrochlorothiazide </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Cohort Entry Events<span class="sc">:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  People enter the cohort when observing any of the following<span class="sc">:</span> drug exposures of</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">'Hydrochlorothiazide'</span>.</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>Limit cohort entry events to the earliest event per person.</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>Cohort Exit<span class="sc">:</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  The cohort end date will be based on a continuous exposure to <span class="st">'Hydrochlorothiazide'</span><span class="sc">:</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  allowing <span class="dv">0</span> days between exposures, adding <span class="dv">0</span> days after exposure ends, and using days</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>supply and exposure end date <span class="cf">for</span> exposure duration.</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>Cohort Eras<span class="sc">:</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  Entry events will be combined into cohort eras <span class="cf">if</span> they are within <span class="dv">30</span> days of each other.</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="do">### The other event cohorts (metorolol, amlodipine, lisinopril, losartan) are defined</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="do">### similarly </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-2-optional-only-for-omop-cdm-data-specify-baseline-characteristics-of-interest-characterizationsettings">Step 2: (optional, only for OMOP-CDM data) specify baseline
characteristics of interest (characterizationSettings)<a class="anchor" aria-label="anchor" href="#step-2-optional-only-for-omop-cdm-data-specify-baseline-characteristics-of-interest-characterizationsettings"></a>
</h2>
<p>Determine which covariates are of interest for baseline
characterization and select these from the large set of pre-defined
covariates as defined by <em>standardCovariateSettings</em> (as defined
by createCovariateSettings function in FeatureExtraction package) or
create (a) custom covariate(s) using SQL. One can choose to present
“all” or only “selected” covariates as specified in
<em>baselineCovariates</em>. When using a characteristic of interest
from FeatureExtraction we need to make sure it is included in
<em>standardCovariateSettings</em>. For the example in this vignette we
use the following default characteristics in
<em>baselineCovariates</em>:</p>
<table class="table">
<thead><tr class="header">
<th align="left">covariateName</th>
<th align="right">covariateId</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Male</td>
<td align="right">8507001</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="right">1002</td>
</tr>
<tr class="odd">
<td align="left">Charlson comorbidity index score</td>
<td align="right">1901</td>
</tr>
</tbody>
</table>
<p>Code examples:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># default return all covariates of standardCovariateSettings</span></span>
<span><span class="va">characterizationSettings</span> <span class="op">&lt;-</span> <span class="fu">createCharacterizationSettings</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># return selection of covariates in default baselineCovariates (male, age, ccomorbidity index score)</span></span>
<span><span class="va">characterizationSettings</span> <span class="op">&lt;-</span> <span class="fu">createCharacterizationSettings</span><span class="op">(</span>returnCovariates <span class="op">=</span> <span class="st">"selection"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">characterizationSettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">createCharacterizationSettings</span><span class="op">(</span>baselineCovariates <span class="op">=</span></span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>covariateName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>, <span class="st">'Age'</span>, </span>
<span>                                                                <span class="st">'Charlson comorbidity index score'</span><span class="op">)</span>,</span>
<span>                                              covariateId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8507001</span>, <span class="fl">1002</span>, <span class="fl">1901</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                 returnCovariates <span class="op">=</span> <span class="st">"selection"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-3-specify-settings-to-construct-treatment-pathways-pathwaysettings">Step 3: specify settings to construct treatment pathways
(pathwaySettings)<a class="anchor" aria-label="anchor" href="#step-3-specify-settings-to-construct-treatment-pathways-pathwaysettings"></a>
</h2>
<p>The settings below are part of <em>pathwaySettings</em> and allow the
user to influence how the events of interest should be processed to form
treatment pathways. For the example in this vignette we used the default
settings:</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="8%">
<col width="76%">
</colgroup>
<thead><tr class="header">
<th align="left">param</th>
<th align="left">values</th>
<th align="left">description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">studyName</td>
<td align="left">default</td>
<td align="left">Unique name identifying the set of study parameters
below</td>
</tr>
<tr class="even">
<td align="left">targetCohortId</td>
<td align="left">1</td>
<td align="left">Select one study population</td>
</tr>
<tr class="odd">
<td align="left">eventCohortIds</td>
<td align="left">10,11,12,13,14</td>
<td align="left">Select all treatments of interest</td>
</tr>
<tr class="even">
<td align="left">periodPriorToIndex</td>
<td align="left">0</td>
<td align="left">Number of days prior to the index date of the target
cohort that event cohorts are allowed to start</td>
</tr>
<tr class="odd">
<td align="left">minEraDuration</td>
<td align="left">0</td>
<td align="left">Minimum time an event era should last to be included in
analysis</td>
</tr>
<tr class="even">
<td align="left">splitEventCohorts</td>
<td align="left"></td>
<td align="left">Specify event cohort to split in acute (&lt; X days)
and therapy (&gt;= X days)</td>
</tr>
<tr class="odd">
<td align="left">splitTime</td>
<td align="left">30</td>
<td align="left">Specify number of days (X) at which each of the split
event cohorts should be split in acute and therapy</td>
</tr>
<tr class="even">
<td align="left">eraCollapseSize</td>
<td align="left">30</td>
<td align="left">Window of time between which two eras of the same event
cohort are collapsed into one era</td>
</tr>
<tr class="odd">
<td align="left">combinationWindow</td>
<td align="left">30</td>
<td align="left">Window of time two event cohorts need to overlap to be
considered a combination treatment</td>
</tr>
<tr class="even">
<td align="left">minPostCombinationDuration</td>
<td align="left">30</td>
<td align="left">Minimum time an event era before or after a generated
combination treatment should last to be included in analysis</td>
</tr>
<tr class="odd">
<td align="left">filterTreatments</td>
<td align="left">First</td>
<td align="left">Select first occurrence of (‘First’) / changes between
(‘Changes’) / all event cohorts (‘All’)</td>
</tr>
<tr class="even">
<td align="left">maxPathLength</td>
<td align="left">5</td>
<td align="left">Maximum number of steps included in treatment
pathway</td>
</tr>
<tr class="odd">
<td align="left">minCellCount</td>
<td align="left">5</td>
<td align="left">Minimum number of persons with a specific treatment
pathway for the pathway to be included in analysis</td>
</tr>
<tr class="even">
<td align="left">minCellMethod</td>
<td align="left">Remove</td>
<td align="left">Select to completely remove / sequentially adjust (by
removing last step as often as necessary) treatment pathways below
minCellCount</td>
</tr>
<tr class="odd">
<td align="left">groupCombinations</td>
<td align="left">10</td>
<td align="left">Select to group all non-fixed combinations in one
category ‘other’ in the sunburst plot</td>
</tr>
<tr class="even">
<td align="left">addNoPaths</td>
<td align="left">FALSE</td>
<td align="left">Select to include untreated persons without treatment
pathway in the sunburst plot</td>
</tr>
</tbody>
</table>
<div class="figure">
<img src="../reference/figures/pathwaysettings.png" alt="Visualizes some of the important parameters." width="100%"><p class="caption">
Visualizes some of the important parameters.
</p>
</div>
<p>Adjust the default parameters according to the needs of your study.
It is possible to add multiple studies at the same time by specifying
different sets of pathway settings with <em>addPathwaySettings</em>.
Note: only when multiple settings are run at the same time, the results
will be displayed together in the shiny application.</p>
<p>Code examples:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use all default settings, only specify targetCohortId and eventCohortIds (mandatory)</span></span>
<span><span class="va">pathwaySettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPathwaySettings.html">createPathwaySettings</a></span><span class="op">(</span>targetCohortId <span class="op">=</span> <span class="fl">1</span>, eventCohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pathwaySettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPathwaySettings.html">createPathwaySettings</a></span><span class="op">(</span></span>
<span>pathwaySettings_list <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/addPathwaySettings.html">addPathwaySettings</a></span><span class="op">(</span>studyName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span>,</span>
<span>                                              targetCohortId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                              eventCohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># specify different sets of pathway settings, with adjusted settings</span></span>
<span><span class="va">pathwaySettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPathwaySettings.html">createPathwaySettings</a></span><span class="op">(</span></span>
<span>  pathwaySettings_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/addPathwaySettings.html">addPathwaySettings</a></span><span class="op">(</span>studyName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span>,</span>
<span>                                                 targetCohortId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                                 eventCohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="../reference/addPathwaySettings.html">addPathwaySettings</a></span><span class="op">(</span>studyName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mineraduration"</span><span class="op">)</span>,</span>
<span>                                                 targetCohortId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                                 eventCohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>                                                 minEraDuration <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-4-execute-study">Step 4: execute study<a class="anchor" aria-label="anchor" href="#step-4-execute-study"></a>
</h2>
<p>The complete treatment patterns study can be run with the following
command after defining the setting objects (see Package manual for
functions to create these):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">TreatmentPatterns</span><span class="fu">::</span><span class="fu"><a href="../reference/executeTreatmentPatterns.html">executeTreatmentPatterns</a></span><span class="op">(</span>dataSettings <span class="op">=</span> <span class="va">dataSettings</span>,</span>
<span>                                            cohortSettings <span class="op">=</span> <span class="va">cohortSettings</span>,</span>
<span>                                            characterizationSettings <span class="op">=</span> <span class="va">characterizationSettings</span>,</span>
<span>                                            pathwaySettings <span class="op">=</span> <span class="va">pathwaySettings</span>,</span>
<span>                                            saveSettings <span class="op">=</span> <span class="va">saveSettings</span><span class="op">)</span></span></code></pre></div>
<p>There are two main approaches to define setting objects:</p>
<ol style="list-style-type: upper-alpha">
<li>by using function arguments when calling package functions
(recommended) or,</li>
<li>by referring to pre-specified setting files in a folder.</li>
</ol>
<p>We give the code for both approaches for databases in ‘OMOP CDM’ and
‘other’ format for the example in this vignette. One can try to run
these examples to become familiar with the package.</p>
<div class="section level4">
<h4 id="omop-cdm-format---approach-a-using-function-arguments-when-calling-package-functions">OMOP CDM format - approach A) Using function arguments when calling
package functions<a class="anchor" aria-label="anchor" href="#omop-cdm-format---approach-a-using-function-arguments-when-calling-package-functions"></a>
</h4>
<p>Code example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TreatmentPatterns</span><span class="op">)</span></span>
<span><span class="va">dataSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDataSettings.html">createDataSettings</a></span><span class="op">(</span>OMOP_CDM <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   connectionDetails <span class="op">=</span> <span class="fu">DatabaseConnector</span><span class="fu">::</span></span>
<span>                                     <span class="fu"><a href="https://ohdsi.github.io/DatabaseConnector/reference/createConnectionDetails.html" class="external-link">createConnectionDetails</a></span><span class="op">(</span>dbms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'dbms'</span><span class="op">)</span>,</span>
<span>                                                             server <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'server'</span><span class="op">)</span>,</span>
<span>                                                             user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'user'</span><span class="op">)</span>,</span>
<span>                                                             password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'password'</span><span class="op">)</span>,</span>
<span>                                                             port <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'port'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                   cdmDatabaseSchema <span class="op">=</span> <span class="st">'cdm'</span>,</span>
<span>                                   cohortDatabaseSchema <span class="op">=</span> <span class="st">'results'</span>,</span>
<span>                                   cohortTable <span class="op">=</span> <span class="st">"treatmentpatterns_cohorts"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohortSettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/createCohortSettings.html">createCohortSettings</a></span><span class="op">(</span></span>
<span>    targetCohorts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cohortId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                               atlasId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1777380</span><span class="op">)</span>,</span>
<span>                               cohortName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Hypertension'</span><span class="op">)</span>,</span>
<span>                               conceptSet <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>    eventCohorts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cohortId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>                              atlasId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1777381</span>,<span class="fl">1777382</span>, <span class="fl">1777383</span>, <span class="fl">1777384</span>, <span class="fl">1777385</span><span class="op">)</span>,</span>
<span>                              cohortName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Hydrochlorothiazide'</span>, <span class="st">'Metorolol'</span>,</span>
<span>                                             <span class="st">'Amlodipine'</span>, <span class="st">'Lisinopril'</span>, <span class="st">'Losartan'</span><span class="op">)</span>,</span>
<span>                              conceptSet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    baseUrl <span class="op">=</span> <span class="st">"http://api.ohdsi.org:8080/WebAPI"</span>,</span>
<span>    loadCohorts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">characterizationSettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">createCharacterizationSettings</span><span class="op">(</span>baselineCovariates <span class="op">=</span></span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>covariateName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>, <span class="st">'Age'</span>, </span>
<span>                                                                <span class="st">'Charlson comorbidity index score'</span><span class="op">)</span>,</span>
<span>                                              covariateId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8507001</span>, <span class="fl">1002</span>, <span class="fl">1901</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                 returnCovariates <span class="op">=</span> <span class="st">"selection"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pathwaySettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPathwaySettings.html">createPathwaySettings</a></span><span class="op">(</span>targetCohortId <span class="op">=</span> <span class="fl">1</span>, eventCohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">saveSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSaveSettings.html">createSaveSettings</a></span><span class="op">(</span>databaseName <span class="op">=</span> <span class="st">"IPCI"</span>, rootFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TreatmentPatterns</span><span class="fu">::</span><span class="fu"><a href="../reference/executeTreatmentPatterns.html">executeTreatmentPatterns</a></span><span class="op">(</span>dataSettings <span class="op">=</span> <span class="va">dataSettings</span>,</span>
<span>                                            cohortSettings <span class="op">=</span> <span class="va">cohortSettings</span>,</span>
<span>                                            characterizationSettings <span class="op">=</span> <span class="va">characterizationSettings</span>,</span>
<span>                                            pathwaySettings <span class="op">=</span> <span class="va">pathwaySettings</span>,</span>
<span>                                            saveSettings <span class="op">=</span> <span class="va">saveSettings</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="omop-cdm-format---approach-b-referring-to-pre-specified-setting-files-in-a-folder">OMOP CDM format - approach B) Referring to pre-specified setting
files in a folder<a class="anchor" aria-label="anchor" href="#omop-cdm-format---approach-b-referring-to-pre-specified-setting-files-in-a-folder"></a>
</h4>
<p>Code example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TreatmentPatterns</span><span class="op">)</span></span>
<span><span class="va">dataSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDataSettings.html">createDataSettings</a></span><span class="op">(</span>OMOP_CDM <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   connectionDetails <span class="op">=</span> <span class="fu">DatabaseConnector</span><span class="fu">::</span></span>
<span>                                     <span class="fu"><a href="https://ohdsi.github.io/DatabaseConnector/reference/createConnectionDetails.html" class="external-link">createConnectionDetails</a></span><span class="op">(</span>dbms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'dbms'</span><span class="op">)</span>,</span>
<span>                                                             server <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'server'</span><span class="op">)</span>,</span>
<span>                                                             user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'user'</span><span class="op">)</span>,</span>
<span>                                                             password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'password'</span><span class="op">)</span>,</span>
<span>                                                             port <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'port'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                   cdmDatabaseSchema <span class="op">=</span> <span class="st">'cdm'</span>,</span>
<span>                                   cohortDatabaseSchema <span class="op">=</span> <span class="st">'results'</span>,</span>
<span>                                   cohortTable <span class="op">=</span> <span class="st">"treatmentpatterns_cohorts"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohortSettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/createCohortSettings.html">createCohortSettings</a></span><span class="op">(</span></span>
<span>    cohortsToCreate_location <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                <span class="st">"examples"</span>, <span class="st">"OMOP CDM"</span>, <span class="st">"inst"</span>, <span class="st">"settings"</span>, <span class="st">"cohorts_to_create.csv"</span><span class="op">)</span>,</span>
<span>    cohortsFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                              <span class="st">"examples"</span>, <span class="st">"OMOP CDM"</span>, <span class="st">"inst"</span>, <span class="st">"cohorts"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">characterizationSettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">createCharacterizationSettings</span><span class="op">(</span>baselineCovariates_location <span class="op">=</span></span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                                             <span class="st">"examples"</span>, <span class="st">"OMOP CDM"</span>, <span class="st">"inst"</span>, <span class="st">"settings"</span>, </span>
<span>                                             <span class="st">"characterization_settings.csv"</span><span class="op">)</span>,</span>
<span>                                 returnCovariates <span class="op">=</span> <span class="st">"selection"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pathwaySettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/createPathwaySettings.html">createPathwaySettings</a></span><span class="op">(</span>pathwaySettings_location <span class="op">=</span></span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                                    <span class="st">"examples"</span>, <span class="st">"OMOP CDM"</span>, <span class="st">"inst"</span>, <span class="st">"settings"</span>, <span class="st">"pathway_settings.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">saveSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSaveSettings.html">createSaveSettings</a></span><span class="op">(</span>databaseName <span class="op">=</span> <span class="st">"IPCI"</span>, rootFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TreatmentPatterns</span><span class="fu">::</span><span class="fu"><a href="../reference/executeTreatmentPatterns.html">executeTreatmentPatterns</a></span><span class="op">(</span>dataSettings <span class="op">=</span> <span class="va">dataSettings</span>,</span>
<span>                                            cohortSettings <span class="op">=</span> <span class="va">cohortSettings</span>,</span>
<span>                                            characterizationSettings <span class="op">=</span> <span class="va">characterizationSettings</span>,</span>
<span>                                            pathwaySettings <span class="op">=</span> <span class="va">pathwaySettings</span>,</span>
<span>                                            saveSettings <span class="op">=</span> <span class="va">saveSettings</span><span class="op">)</span></span></code></pre></div>
<p>Format of files, see examples:</p>
<ul>
<li><p>inst/examples/OMOP
CDM/inst/settings/cohorts_to_create.csv</p></li>
<li><p>inst/examples/OMOP
CDM/inst/settings/characterization_settings.csv</p></li>
<li><p>inst/examples/OMOP
CDM/inst/settings/pathway_settings.csv</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="other-format---approach-a-using-function-arguments-when-calling-package-functions">Other format - approach A) Using function arguments when calling
package functions<a class="anchor" aria-label="anchor" href="#other-format---approach-a-using-function-arguments-when-calling-package-functions"></a>
</h4>
<p>Code example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TreatmentPatterns</span><span class="op">)</span></span>
<span><span class="va">dataSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDataSettings.html">createDataSettings</a></span><span class="op">(</span>OMOP_CDM <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                   cohortLocation <span class="op">=</span></span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                                               <span class="st">"examples"</span>, <span class="st">"other format"</span>, <span class="st">"inst"</span>,</span>
<span>                                               <span class="st">"cohorts"</span>, <span class="st">"input_cohorts.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohortSettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/createCohortSettings.html">createCohortSettings</a></span><span class="op">(</span></span>
<span>    targetCohorts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cohortId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                               cohortName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Hypertension'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    eventCohorts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cohortId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>                              cohortName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Hydrochlorothiazide'</span>, <span class="st">'Metorolol'</span>,</span>
<span>                                             <span class="st">'Amlodipine'</span>, <span class="st">'Lisinopril'</span>, <span class="st">'Losartan'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    cohortsFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                              <span class="st">"examples"</span>, <span class="st">"other format"</span>, <span class="st">"inst"</span>, <span class="st">"cohorts"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pathwaySettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPathwaySettings.html">createPathwaySettings</a></span><span class="op">(</span>targetCohortId <span class="op">=</span> <span class="fl">1</span>, eventCohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">saveSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSaveSettings.html">createSaveSettings</a></span><span class="op">(</span>databaseName <span class="op">=</span> <span class="st">"IPCI"</span>, rootFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TreatmentPatterns</span><span class="fu">::</span><span class="fu"><a href="../reference/executeTreatmentPatterns.html">executeTreatmentPatterns</a></span><span class="op">(</span>dataSettings <span class="op">=</span> <span class="va">dataSettings</span>,</span>
<span>                                            cohortSettings <span class="op">=</span> <span class="va">cohortSettings</span>,</span>
<span>                                            pathwaySettings <span class="op">=</span> <span class="va">pathwaySettings</span>,</span>
<span>                                            saveSettings <span class="op">=</span> <span class="va">saveSettings</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="other-format---approach-b-referring-to-pre-specified-setting-files-in-a-folder">Other format - approach B) Referring to pre-specified setting files
in a folder<a class="anchor" aria-label="anchor" href="#other-format---approach-b-referring-to-pre-specified-setting-files-in-a-folder"></a>
</h4>
<p>Code example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TreatmentPatterns</span><span class="op">)</span></span>
<span><span class="va">dataSettings</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/createDataSettings.html">createDataSettings</a></span><span class="op">(</span>OMOP_CDM <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  cohortLocation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                                                             <span class="st">"examples"</span>, <span class="st">"other format"</span>, <span class="st">"inst"</span>,</span>
<span>                                                             <span class="st">"cohorts"</span>, <span class="st">"input_cohorts.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cohortSettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/createCohortSettings.html">createCohortSettings</a></span><span class="op">(</span></span>
<span>    cohortsToCreate_location <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                <span class="st">"examples"</span>, <span class="st">"other format"</span>, <span class="st">"inst"</span>, <span class="st">"settings"</span>, <span class="st">"cohorts_to_create.csv"</span><span class="op">)</span>,</span>
<span>    cohortsFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                              <span class="st">"examples"</span>, <span class="st">"other format"</span>, <span class="st">"inst"</span>, <span class="st">"cohorts"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pathwaySettings</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/createPathwaySettings.html">createPathwaySettings</a></span><span class="op">(</span></span>
<span>    pathwaySettings_location <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                <span class="st">"examples"</span>, <span class="st">"other format"</span>, <span class="st">"inst"</span>, <span class="st">"settings"</span>, <span class="st">"pathway_settings.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">saveSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSaveSettings.html">createSaveSettings</a></span><span class="op">(</span>databaseName <span class="op">=</span> <span class="st">"IPCI"</span>, rootFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TreatmentPatterns</span><span class="fu">::</span><span class="fu"><a href="../reference/executeTreatmentPatterns.html">executeTreatmentPatterns</a></span><span class="op">(</span>dataSettings <span class="op">=</span> <span class="va">dataSettings</span>,</span>
<span>                                            cohortSettings <span class="op">=</span> <span class="va">cohortSettings</span>,</span>
<span>                                            pathwaySettings <span class="op">=</span> <span class="va">pathwaySettings</span>,</span>
<span>                                            saveSettings <span class="op">=</span> <span class="va">saveSettings</span><span class="op">)</span></span></code></pre></div>
<p>Format of files, see examples:</p>
<ul>
<li><p>inst/examples/other
format/inst/settings/cohorts_to_create.csv</p></li>
<li><p>inst/examples/other
format/inst/settings/pathway_settings.csv</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="step-5-check-out-results">Step 5: check out results<a class="anchor" aria-label="anchor" href="#step-5-check-out-results"></a>
</h2>
<ul>
<li><p>The results are combined in an automatically generated zip file
per database</p></li>
<li><p>Select the folder containing the zip files and run the Shiny App
for an interactive visualization of the results:</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">TreatmentPatterns</span><span class="fu">::</span><span class="fu"><a href="../reference/launchResultsExplorer.html">launchResultsExplorer</a></span><span class="op">(</span>saveSettings <span class="op">=</span> <span class="va">saveSettings</span><span class="op">)</span></span>
<span><span class="fu">TreatmentPatterns</span><span class="fu">::</span><span class="fu"><a href="../reference/launchResultsExplorer.html">launchResultsExplorer</a></span><span class="op">(</span>outputFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">saveSettings</span><span class="op">$</span><span class="va">rootFolder</span>, <span class="st">"output"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">TreatmentPatterns</span><span class="fu">::</span><span class="fu"><a href="../reference/launchResultsExplorer.html">launchResultsExplorer</a></span><span class="op">(</span>zipFolder <span class="op">=</span> <span class="va">saveSettings</span><span class="op">$</span><span class="va">rootFolder</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>Note: the sunburst plots are only visible on a computer with
internet due to JavaScript library dependencies.</p></li>
<li><p>Share zip folder with results</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="extra-options">Extra options<a class="anchor" aria-label="anchor" href="#extra-options"></a>
</h2>
<div class="section level3">
<h3 id="a-stand-alone-sunburst-plot-functionality">A) Stand alone sunburst plot functionality<a class="anchor" aria-label="anchor" href="#a-stand-alone-sunburst-plot-functionality"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"TreatmentPatterns"</span><span class="op">)</span>,</span>
<span>                                  <span class="st">"examples"</span>, <span class="st">"sequences.csv"</span><span class="op">)</span>,</span>
<span>                        col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"i"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/createSunburstPlot.html">createSunburstPlot</a></span><span class="op">(</span><span class="va">data</span>, folder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"/output"</span><span class="op">)</span>,</span>
<span>                   file_name <span class="op">=</span> <span class="st">"example"</span>, shiny <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   title <span class="op">=</span> <span class="st">"example sequences.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Note: the sunburst plots are only visible on a computer with internet
due to JavaScript library dependencies.</p>
</div>
<div class="section level3">
<h3 id="b-custom-cohorts-advanced---step-1">B) Custom cohorts (advanced - step 1)<a class="anchor" aria-label="anchor" href="#b-custom-cohorts-advanced---step-1"></a>
</h3>
<p>Alternatively custom cohorts can be created using a concept set and
template. In the package there is a cohort template available for drugs
(inst/SQL/CohortDrugTemplate.sql). This template identifies all drug
exposures of the concept set till the end of a continuous exposure with
a maximum persistence window of 30 days. If you want to make use of this
option, you need to specify the concepts set for each cohort of interest
and specify whether or not to <em>includeDescendants</em>.</p>
</div>
<div class="section level3">
<h3 id="c-custom-covariates-advanced---step-2">C) Custom covariates (advanced - step 2)<a class="anchor" aria-label="anchor" href="#c-custom-covariates-advanced---step-2"></a>
</h3>
<p>If desired, one can add custom covariates for characterization. An
example template is given below:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>SELECT <span class="sc">@</span>covariateId AS covariate_id,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>{<span class="sc">@</span>aggregated} ? {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  cohort_definition_id,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">COUNT</span>(DISTINCT target.<span class="sc">@</span>rowIdField) AS sum_value</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>} <span class="sc">:</span> {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  target.<span class="sc">@</span>rowIdField  AS row_id,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> AS covariate_value</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>FROM <span class="sc">@</span>cohortTable target</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>INNER JOIN <span class="sc">@</span>cdmDatabaseSchema.condition_occurrence covariate</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>ON covariate.person_id <span class="ot">=</span> target.<span class="sc">@</span>rowIdField </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>WHERE covariate.condition_concept_id <span class="fu">IN</span> (..)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>AND covariate.condition_start_date <span class="sc">&lt;=</span> target.cohort_start_date</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>{<span class="sc">@</span>cohortId <span class="sc">!=</span> <span class="sc">-</span><span class="dv">1</span>} ? {AND cohort_definition_id <span class="fu">IN</span> (<span class="sc">@</span>cohortId)}</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>{<span class="sc">@</span>aggregated} ? {GROUP BY cohort_definition_id}</span></code></pre></div>
<p>The custom covariates need to be specified in
<em>baselineCovariates</em> with covariateId = “Custom”.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maarten van Kessel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
